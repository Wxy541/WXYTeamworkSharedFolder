å½“ç„¶å¯ä»¥ï¼æˆ‘ä»¬æ ¹æ®ä½ æä¾›çš„è®ºæ–‡æ®µè½ï¼ˆå…³äºŽ **Token2Embedding** çš„æè¿°ï¼‰ï¼Œç»“åˆå…¸åž‹çš„ BERT-style æž¶æž„è®¾è®¡ï¼Œç»™å‡ºä¸€ä¸ª**å…·ä½“æ•°å€¼ç¤ºä¾‹**ï¼Œè¯´æ˜Ž **token embeddingã€position embedding å’Œ segment embedding** æ˜¯å¦‚ä½•åˆ†åˆ«ç”Ÿæˆå¹¶æœ€ç»ˆç›¸åŠ å¾—åˆ°å®Œæ•´ token è¡¨ç¤ºçš„ã€‚

---

### ðŸŽ¯ ç›®æ ‡

å¯¹ä¸€ä¸ªå…·ä½“çš„è¾“å…¥ tokenï¼ˆä¾‹å¦‚æ¥è‡ªåŠ å¯†æµé‡çš„ bi-gram token `5635`ï¼‰ï¼Œè®¡ç®—å…¶å®Œæ•´çš„ embedding å‘é‡ï¼š

$$E_{\text{total}} = E_{\text{token}} + E_{\text{pos}} + E_{\text{seg}}$$

å…¶ä¸­æ¯ä¸ªåˆ†é‡éƒ½æ˜¯ 768 ç»´å‘é‡ï¼ˆ(H = 768)ï¼‰ã€‚

---

### ðŸ“Œ å‡è®¾åœºæ™¯

è€ƒè™‘ä¸€ä¸ªç®€åŒ–çš„è¾“å…¥åºåˆ—ï¼ˆç”¨äºŽåˆ†ç±»ä»»åŠ¡ï¼‰ï¼š

```
[CLS] 5635 258 20 [SEP]
```

- åºåˆ—é•¿åº¦ = 5
- æˆ‘ä»¬å…³æ³¨ç¬¬ 2 ä¸ªä½ç½®çš„ tokenï¼š`5635`
- å®ƒå±žäºŽ **ç¬¬ä¸€ä¸ª sub-BURSTï¼ˆsegment Aï¼‰**

> æ³¨ï¼šåœ¨å¾®è°ƒé˜¶æ®µï¼Œæ•´æ¡æµä½œä¸ºä¸€ä¸ª segmentï¼Œä½†é¢„è®­ç»ƒæ—¶å¯èƒ½æœ‰ä¸¤ä¸ª segmentsï¼ˆA/Bï¼‰ã€‚æ­¤å¤„æŒ‰é¢„è®­ç»ƒè®¾å®šä¸¾ä¾‹ã€‚

---

### ç¬¬ä¸€æ­¥ï¼šToken Embedding (E_{\text{token}})

- è®ºæ–‡æåˆ°ï¼šâ€œrepresentation of the token learn from the lookup table... called token embeddingâ€
- è¿™æ˜¯ä¸€ä¸ª **å¯å­¦ä¹ çš„åµŒå…¥è¡¨ï¼ˆembedding lookup tableï¼‰**ï¼Œå¤§å°ä¸º (V \times 768)ï¼Œå…¶ä¸­ (V) æ˜¯è¯æ±‡è¡¨å¤§å°ï¼ˆå¦‚ 65536ï¼Œå› ä¸º bi-gram èŒƒå›´æ˜¯ 0~65535ï¼ŒåŠ ä¸Šç‰¹æ®Š tokenï¼‰ã€‚
- æ¯ä¸ª token ID å¯¹åº”ä¸€è¡Œå‘é‡ã€‚

âœ… **ä¸¾ä¾‹**ï¼š

- token ID = `5635`
- æŸ¥åµŒå…¥è¡¨ â†’ å¾—åˆ°ä¸€ä¸ªéšæœºåˆå§‹åŒ–ï¼ˆåŽç»­è®­ç»ƒæ›´æ–°ï¼‰çš„ 768 ç»´å‘é‡ï¼š
$$ E_{\text{token}} = \begin{bmatrix} 0.12 \ -0.45 \ 0.67 \ \vdots \ 0.03 \end{bmatrix} \in \mathbb{R}^{768} $$

ï¼ˆå®žé™…å€¼ç”±æ¨¡åž‹å‚æ•°å†³å®šï¼Œåˆå§‹ä¸ºéšæœºï¼‰

---

### ç¬¬äºŒæ­¥ï¼šPosition Embedding (E_{\text{pos}})

- ç”±äºŽæµé‡é¡ºåºå¾ˆé‡è¦ï¼Œæ¯ä¸ª**ä½ç½®**ï¼ˆä»Ž 0 å¼€å§‹æˆ– 1 å¼€å§‹ï¼‰éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ 768 ç»´å‘é‡ã€‚
- è®ºæ–‡æœªè¯´æ˜Žä½¿ç”¨ **å¯å­¦ä¹  position embedding** è¿˜æ˜¯ **æ­£å¼¦/ä½™å¼¦ï¼ˆå¦‚ Transformer åŽŸå§‹ç‰ˆï¼‰**ï¼Œä½† BERT ç±»æ¨¡åž‹é€šå¸¸ç”¨**å¯å­¦ä¹ çš„ position embedding**ã€‚

âœ… **ä¸¾ä¾‹**ï¼š

- token `5635` åœ¨åºåˆ—ä¸­çš„ä½ç½®æ˜¯ **1**ï¼ˆå‡è®¾ `[CLS]` åœ¨ä½ç½® 0ï¼‰
- æŸ¥ position embedding è¡¨ï¼ˆå¤§å°ä¸º max_len Ã— 768ï¼Œå¦‚ 512Ã—768ï¼‰â†’ ä½ç½® 1 å¯¹åº”çš„å‘é‡ï¼š

$$ E_{\text{pos}} = \begin{bmatrix} -0.21 \ 0.33 \ 0.05 \ \vdots \ -0.11 \end{bmatrix} \in \mathbb{R}^{768} $$

---

### ç¬¬ä¸‰æ­¥ï¼šSegment Embedding (E_{\text{seg}})

- ç”¨äºŽåŒºåˆ†ä¸åŒ segmentï¼ˆå¦‚ sub-BURST A vs Bï¼‰
- åªæœ‰ä¸¤ç§ segmentï¼šAï¼ˆID=0ï¼‰å’Œ Bï¼ˆID=1ï¼‰
- æ¯ä¸ª segment ID å¯¹åº”ä¸€ä¸ª 768 ç»´å¯å­¦ä¹ å‘é‡

âœ… **ä¸¾ä¾‹**ï¼š

- `5635` å±žäºŽ **segment A** â†’ segment ID = 0
- æŸ¥ segment embedding è¡¨ï¼ˆ2Ã—768ï¼‰â†’ å¾—åˆ°ï¼š

$$ E_{\text{seg}} = \begin{bmatrix} 0.05 \ 0.10 \ -0.20 \ \vdots \ 0.15 \end{bmatrix} \in \mathbb{R}^{768} $$

> ðŸ’¡ åœ¨å¾®è°ƒé˜¶æ®µï¼Œæ•´æ¡æµè§†ä¸ºä¸€ä¸ª segmentï¼Œæ‰€ä»¥æ‰€æœ‰ token çš„ segment ID éƒ½ç›¸åŒï¼ˆæ¯”å¦‚å…¨ä¸º 0ï¼‰ã€‚

---

### ç¬¬å››æ­¥ï¼šæ±‚å’Œ â†’ å®Œæ•´ Token è¡¨ç¤º

å°†ä¸‰ä¸ªå‘é‡é€å…ƒç´ ç›¸åŠ ï¼š

[ E_{\text{total}} = E_{\text{token}} + E_{\text{pos}} + E_{\text{seg}} ]

ä¾‹å¦‚å‰ 3 ç»´è®¡ç®—å¦‚ä¸‹ï¼š

| åˆ†é‡                 | dim 0     | dim 1     | dim 2    |
| ------------------ | --------- | --------- | -------- |
| $E_{\text{token}}$ | 0.12      | -0.45     | 0.67     |
| $E_{\text{pos}}$   | -0.21     | 0.33      | 0.05     |
| $E_{\text{seg}}$   | 0.05      | 0.10      | -0.20    |
| **Sum**            | **-0.04** | **-0.02** | **0.52** |

æœ€ç»ˆå¾—åˆ°ï¼š

$$E_{\text{total}} = \begin{bmatrix} -0.04 \ -0.02 \ 0.52 \ \vdots \ \text{(768ç»´)} \end{bmatrix}$$

è¿™ä¸ªå‘é‡å°±æ˜¯è¾“å…¥åˆ° **Transformer ç¬¬ä¸€å±‚** çš„è¡¨ç¤ºã€‚

---

### ðŸ” åŽç»­å¤„ç†

- æ‰€æœ‰åºåˆ—ä¸­æ¯ä¸ª token éƒ½è¿™æ ·è®¡ç®— (E_{\text{total}})
- å°†æ•´ä¸ªåºåˆ—çš„ embedding çŸ©é˜µï¼ˆshape: `seq_len Ã— 768`ï¼‰é€å…¥ **N å±‚ Transformer encoder**
- æœ€ç»ˆè¾“å‡ºæ¯ä¸ª token çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥è¡¨ç¤ºï¼ˆå¦‚ `[CLS]` çš„æœ€ç»ˆå‘é‡ç”¨äºŽåˆ†ç±»ï¼‰

---

### âœ… æ€»ç»“ï¼šEmbedding è®¡ç®—æµç¨‹ï¼ˆä»¥ token `5635` ä¸ºä¾‹ï¼‰

|æ­¥éª¤|æ¥æº|å‘é‡ç»´åº¦|ç¤ºä¾‹å€¼ï¼ˆç¤ºæ„ï¼‰|
|---|---|---|---|
|1. Token Embedding|æŸ¥ token ID=5635 çš„åµŒå…¥è¡¨|768|`[0.12, -0.45, 0.67, ...]`|
|2. Position Embedding|æŸ¥ä½ç½®=1 çš„ä½ç½®è¡¨|768|`[-0.21, 0.33, 0.05, ...]`|
|3. Segment Embedding|æŸ¥ segment ID=0 çš„æ®µè¡¨|768|`[0.05, 0.10, -0.20, ...]`|
|4. æ±‚å’Œ|ä¸‰è€…ç›¸åŠ |768|`[-0.04, -0.02, 0.52, ...]`|

> æ‰€æœ‰ embedding è¡¨ï¼ˆtoken/position/segmentï¼‰éƒ½åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­**ç«¯åˆ°ç«¯å­¦ä¹ æ›´æ–°**ã€‚
