### 数据集与分类任务说明（效果实验）
![[Pasted image 20251108152212.png]]
1. 加密流量分类：
	1. 通用加密应用分类（GEAC）：
		1. 数据集：Cross-Platform(iOS)和Cross-Platform(Android)
		2. 数据集特点：分别包含196和215个应用程序。iOS应用程序和Android应用程序是从美国、中国和印度的前100个应用程序中收集的。该数据集类别数最多，长尾数据分布在所有类别中。
	2. VPN加密流量分类( ETCV )：
		1. 数据集：ISCX- VPN-Service和ISCX-VPN-App
		2. 数据集特点：前者12类应用，后者17类应用
	3. Tor加密应用分类( Encrypted Application Classification on Tor，EACT )：
		1. 数据集：ISCX-Tor
		2. 数据集特点：包含16个应用程序
	4. TLS上加密应用的分类1 . 3 ( EAC1 . 3 )
		1. 数据集：CSTNET-TLS 1.3
		2. 数据集特点：从2021年3月到7月在CSTNET下收集的120个应用，通过服务器名称指示( SNI )对每个会话流进行标记
2. 加密恶意分类：
	1. 加密恶意软件分类( EMC )：
		1. 数据集：USTC-TFC
		2. 数据集特点：包含10类良性流量和10类恶意流量

数据预处理：
1. **删除了**地址解析协议( ARP )和动态主机配置协议( DHCP )中与传输内容的特定流量**无关的数据包**
2. 为了避免数据包报头的影响，可能会在IP和端口等具有强标识信息的有限集合中引入有偏干扰，我们**去除了TCP报头的以太网报头、IP报头和协议端口**
3. 微调阶段：在所有数据集中从每个类中最多随机选择500个流和5000个数据包。每个数据集按照8：1：1的比例分为训练集、验证集和测试集。

指标（均是阈值相关指标）：
1. AC
2. PR
3. RC
4. F1

评价衡量标准和实施细节。我们通过四个典型的指标来评估和比较模型的性能，包括准确率( AC )，精确率( PR )，召回率( RC )和F1。宏平均通过计算每个类别的AC，PR，RC和F1的平均值来避免由于多个类别数据之间的不平衡而导致的有偏结果。

超参数设置：
1. 预训练：批大小为32，总步数为50万步。设置学习率为2 × 10-5，warmup为0.1
2. 微调：使用Adam W优化器，微调10个epochs，其中学习率设置为6 × 10-5（流级），2 × 10 - 5（包级）。批次大小为32，dropout为0.5 

### 消融实验（暂时不懂代码怎么启动，可能存在选择模块的超参数吧）
![[Pasted image 20251108160035.png]]
使用数据集：ISCX-VPN-App（为了公平地比较包级和流级微调方法，我们从每个类中随机选择最多100个包和流作为训练数据集）
验证组件：
- 输入的策略：
	- 预训练阶段：BURST分组的策略：
		- PT-P表示在预训练( PT )中随机选择的相邻分组作为输入
		- PT-B表示在预训练( PT )中BURST分组的作为输入
	- 微调阶段：
		- FT-f：单个流进行微调
		- FT-c：级联流（流拼接起来）进行微调
		- FT-P：单个包进行微调
- 处理组件（packet级别）
	- 去掉SBP
	- 去掉MBM
	- 去掉BURST
- 不进行预训练

如下 7 个模型：
1. 完全体：(SBP+MBM+PT-B)+FT-P
2. SBP消融：(MBM+PT-B)+FT-P
3. MBM消融：(SBP+PT-B)+FT-P
4. BURST消融：(SBP+MBM+PT-P)+FT-P
5. 流微调：(SBP+MBM+PT-B)+FT-f
6. 级联流微调：(SBP+MBM+PT-B)+FT-cf
7. 无预训练：FT-P

### 可解释性实验
理论上，一个理想的加密方案应使生成的消息具有最大可能的熵（简单理解为真随机，完全没有任何规律），ET-BERT 的有效性和泛化能力就源于这些密码算法不是理想的

如下表进行了15组统计检验，对5种密码算法的强度进行了评估，其中 p = 1 表示序列具有完美的随机性：
![[Pasted image 20251108162806.png]]

上述的15种测试可参考：
[[【ET-Bert】加密算法的随机性测试]]

另外：
为评估不同密码算法对 ET-BERT 性能的影响，我们分析了各个数据集中所使用的密码类型分布。如图 3 所示，
1. 横坐标表示占比最高的 13 种密码类型及其他（“others”）
2. 纵坐标表示每种密码在数据集中的占比。

可以看到，**ISCX-VPN、ISCX-Tor 和 USTC-TFC 这三个数据集至少包含 3 种不同的密码算法**，其中包括随机性较弱的 **RC4 和 3DES**；而其他数据集则主要由**单一密码算法**构成。

结合表 2 和表 3 的结果可以看出，**ET-BERT 在那些使用了随机性较弱密码的数据集上取得了接近 100% 的 F1 分数**，且性能波动较大。具体而言，其在 ETCV、EACT 和 EMC 数据集上的平均 F1 分数分别达到了 **99.14%、99.21% 和 99.30%**。

### 小样本分析
目标：验证ET - BERT在小样本情况下的有效性和鲁棒性

在 ISCX-VPN-Service 上设计了不同数据比例的对比实验

我们将每个类别的数据大小设置为500，并随机选择40 %，20 %和10 %的样本进行小样本实验。

在图4中，对比结果说明了预训练方法受数据规模缩减的影响最小。数据规模为40 %、20 %、10 %的ET - BERT (分组)的F1得分分别为95.78 %、98.33 %、91.55 %。

我们的模型在所有方法中取得了最好的结果。相比之下，传统的监督方法( e. g . BIND、DF、FS - Net)在样本量减少时表现出明显的F1性能下降。深度包的性能下降了40.22 %，当样本量从全尺寸减小到10 %时。这表明预训练方法更有效地解决了小样本加密流量的分类问题。









